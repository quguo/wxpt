<!doctype html>
<html class="no-js">
<head>
  <include file="Public:Meta" />
  <!--引入资源文件-->
  <include file="Public:Resources" />
  <link rel="stylesheet" href="__PUBLIC__/assets/css/amazeui.datetimepicker.css">
    <script src="__PUBLIC__/assets/js/amazeui.datetimepicker.zh-CN.js"></script>

</head>
<body>

<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->

<include file="Public:top" />

<div class="am-cf admin-main">

  <!--引入左侧菜单文件-->
  <include file="Public:column" />

    <!-- content start -->
<div class="admin-content">

  <div class="am-cf am-padding">
    <include file="Public:location" />
  </div>

  <div class="am-tabs am-margin" data-am-tabs>
    <ul class="am-tabs-nav am-nav am-nav-tabs">
      <li class="am-active"><a href="#tab1">基本信息</a></li>
     
    </ul>
    
    <div class="am-tabs-bd">

      <div class="am-tab-panel am-fade am-in am-active" id="tab1">
        
        <form action="" class="am-form am-form-inline" id="Form">

           
        <div class="am-g am-margin-top">
          <div class="am-u-sm-4 am-u-md-2 am-text-right">
            门票名称
          </div>
          <div class="am-u-sm-8 am-u-md-10">
           
              <div class="am-form-group">
                <input type="text" class="am-form-field am-input-sm" placeholder="门票名称" name="name" value="<{$info.name}>">
              </div>
          </div>
        </div>

        
       

        <div class="am-g am-margin-top">
          <div class="am-u-sm-4 am-u-md-2 am-text-right">类型</div>
          <div class="am-u-sm-8 am-u-md-10">
            <div class="am-btn-group" data-am-button>
              <label class="type am-btn am-btn-success am-btn-xs <if condition="$info[type] eq 1">am-active</if>">
                <input type="radio" name="type"  value="1" <if condition="$info[type] eq 1">checked</if>> 使用比例
              </label>
              <label class="type am-btn am-btn-success am-btn-xs <if condition="$info[type] eq 2">am-active</if>">
                <input type="radio" name="type"  value="2" <if condition="$info[type] eq 2">checked</if>> 输入价钱
              </label>

               <label class="type am-btn am-btn-success am-btn-xs <if condition="$info[type] eq 3">am-active</if>">
                <input type="radio" name="type"  value="3" <if condition="$info[type] eq 3">checked</if>> 套票
              </label>
              <label class="type am-btn am-btn-success am-btn-xs <if condition="$info[type] eq 4">am-active</if>">
                <input type="radio" name="type"  value="4" <if condition="$info[type] eq 4">checked</if>> 团购
              </label>

            </div>
          </div>
        </div>

        <div class="am-g am-margin-top" id="bill"  style="<if condition="$info[type] eq 1">display:block<else/>display:none</if>">
          <div class="am-u-sm-4 am-u-md-2 am-text-right">
            比例
          </div>
          <div class="am-u-sm-8 am-u-md-10">
           
              <div class="am-form-group">
                <input type="text" class="am-form-field am-input-sm" placeholder="比例" name="bili" value="<{$info.bili}>">
              </div>
            
          </div>
        </div>

         <div class="am-g am-margin-top" id="tuangou_value" style="<if condition="$info[type] eq 4">display:block<else/>display:none</if>">
          <div class="am-u-sm-4 am-u-md-2 am-text-right">
            相应减少
          </div>
          <div class="am-u-sm-8 am-u-md-10">
           
              <div class="am-form-group">
                <input type="text" class="am-form-field am-input-sm" placeholder="相应减少" name="tuangou_value" value="<{$info.tuangou_value}>">
              </div>
            
          </div>
        </div>

        <div class="am-g am-margin-top">
          <div class="am-u-sm-4 am-u-md-2 am-text-right">报表类型(谨慎选择)</div>
          <div class="am-u-sm-8 am-u-md-10">
            <div class="am-btn-group" data-am-button>
              <label class="am-btn am-btn-success am-btn-xs <if condition="$info[countType] eq 1">am-active</if>">
                <input type="radio" name="countType" id="option1" value="1" <if condition="$info[countType] eq 1">checked</if>> 统计折扣票(人数 价钱)
              </label>
              <label class="am-btn am-btn-success am-btn-xs <if condition="$info[countType] eq 2">am-active</if>">
                <input type="radio" name="countType" id="option2" value="2" <if condition="$info[countType] eq 2">checked</if>> 统计折扣票(:人数 折扣 价钱)
              </label>
              <label class="am-btn am-btn-success am-btn-xs <if condition="$info[countType] eq 3">am-active</if>">
                <input type="radio" name="countType" id="option2" value="3" <if condition="$info[countType] eq 3">checked</if>> 统计套票(:套数 人数 价钱)
              </label>
            </div>
          </div>
        </div>

        <div class="am-g am-margin-top">
          <div class="am-u-sm-4 am-u-md-2 am-text-right">状态</div>
          <div class="am-u-sm-8 am-u-md-10">
            <div class="am-btn-group" data-am-button>
              <label class="am-btn am-btn-default am-btn-xs  <if condition="$info[status] eq 1">am-active</if>">
                <input type="radio" name="status" id="option1" value="1" <if condition="$info[status] eq 1">  checked="checked" </if>> 启用
              </label>
              <label class="am-btn am-btn-default am-btn-xs <if condition="$info[status] eq 0">am-active</if>">
                <input type="radio" name="status" id="option2" value="0" <if condition="$info[status] eq 0">  checked="checked"</if>> 禁用
              </label>
              <input type="hidden" name="id" value="<{$info.id}>">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="am-margin">
    <a href="javascript:;" class="am-btn am-btn-primary am-btn-xs" id="add">提交保存</a>
    <button type="button" class="am-btn am-btn-primary am-btn-xs">放弃保存</button>
  </div></form>
</div>
<!-- content end -->
</div>
<include file="Public:footer" />


<include file="Public:callback" />
  <script type="text/javascript">
  $(function(){
      $(".tuangou").click(function(){
          var val = $(this).find("input[name=tuangou]").val();
          if(val == 1){
            $("#tuangou_value").css("display","block");
            
            $("input[name=tuangou_value]").val(<{$info.tuangou_value}>);
          }else{
            $("input[name=tuangou_value]").val("");
            $("#tuangou_value").css("display","none");
          }


      })

      $(".type").click(function(){
          var val = $(this).find("input[name=type]").val();
          if(val == 1){
            
            $("#bill").css("display","block");
            $("#tuangou_value").css("display","none");
            $("input[tuangou_value]").val("");
            $("input[name=bili]").val(<{$info.bili}>);
          }
          else if(val == 4){
            $("#tuangou_value").css("display","block");
            $("input[name=bili]").val("");
            $("input[tuangou_value]").val("<{$info.tuangou_value}>");
            $("#bill").css("display","none");
          }
          else{
            $("input[name=bili]").val("");
            $("input[tuangou_value]").val("");
            $("#bill").css("display","none");
          }
      })
      $("#add").click(function(){
        $(".am-modal-bd").html(" ");
        var value = $("#Form").serialize();
        $.ajax({
          url:'<{:U("Admin/System/editTicketConfig")}>',
          data:value,
          dataType:'json',
          success:function(data){
             if(data.status == 0){
              $(".am-modal-bd").html(data.info);
              $("#callback").modal()
              $("#status").val("0")
            }
            else{
              $(".am-modal-bd").html(data.info);
              $("#status").val("1")
              $("#callback").modal()
              
            }
          },
          type:'POST',
          timeout:1000,
          error:function(){
            alert("网络出错...")
          }
        })
      })

    $("#callback").on('closed.modal.amui',function(){
        var status = $("#status").val();
        if(status != 0){
          window.location='__URL__/ticket'
        }
      })
  })
  </script>
</body>
</html>

